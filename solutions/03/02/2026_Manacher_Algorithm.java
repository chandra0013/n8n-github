public class ManacherAlgorithm { public static String longestPalindrome(String s) { if(s.length() < 2) return s; String t = \"#\"; for(char c : s.toCharArray()) t += c + \"#\"; int[] p = new int[t.length()]; int center = 0, right = 0; for(int i = 1; i < t.length(); i++) { int mirror = 2 * center - i; if(i < right) p[i] = Math.min(right - i, p[mirror]); while(i + p[i] + 1 < t.length() && i - p[i] - 1 >= 0 && t.charAt(i + p[i] + 1) == t.charAt(i - p[i] - 1)) p[i]++; if(i + p[i] > right) { center = i; right = i + p[i]; } } return s; } }